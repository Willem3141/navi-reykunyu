<!doctype html>

<% const languages = [
	['Dutch', 'nl'],
	['Estonian', 'et'],
	['French', 'fr'],
	['German', 'de'],
	['Hungarian', 'hu'],
	['Polish', 'pl'],
	['Russian', 'ru'],
	['Swedish', 'sv'],
];
const types = [
	['n', 'noun'],
	['n:pr', 'proper noun'],
	['n:si', 'si-verb complement'],
	['pn', 'pronoun'],
	['adj', 'adjective'],
	['num', 'numeral'],
	['adv', 'adverb'],
	['adp', 'adposition'],
	['adp:len', 'adposition (leniting)'],
	['intj', 'interjection'],
	['part', 'particle'],
	['conj', 'conjunction'],
	['ctr', 'contraction (‘f-word’)'],
	['v:?', 'verb (unknown type)'],
	['v:in', 'verb (intransitive)'],
	['v:tr', 'verb (transitive)'],
	['v:m', 'verb (modal)'],
	['v:si', 'verb (si itself)'],
	['v:cp', 'verb (copula)'],
	['phr', 'phrase'],
	['inter', 'interrogative'],
	['aff:pre', 'prefix'],
	['aff:in', 'infix'],
	['aff:suf', 'suffix']
]; %>

<html>
	<head>
		<meta charset="utf-8">
		<title>Word editor &bull; Reykunyu</title>
		<link rel="stylesheet" type="text/css" href="aysrungsiyu/semantic/dist/semantic.css">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="tìlam/tìlam.css" rel="stylesheet">
	</head>
	<body data-url="<%= post_url %>">
		<div class="container">
			<h1>
				Word editor
				<% if (user) { %>
				<div id="user-label" class="ui left pointing basic label">
					Kaltxì ma <%= user.username %>!
				</div>
				<% } %>
				<a href="/" class="ui icon right floated top right basic button">
					<i class="arrow left icon"></i> Back to Reykunyu
				</a>
			</h1>
			<div class="ui form">
				<h2>Base information</h2>
				<div class="fields">
					<div class="eight wide field">
						<label>Root word</label>
						<input id="root-field" type="text" placeholder="taron" value="<%= word['na\'vi'] %>">
					</div>
					<div class="eight wide field">
						<label>Type</label>
						<select id="type-field" class="ui selection dropdown">
							<% for (let type of types) { %>
							<option value="<%= type[0] %>"<%= word['type'] === type[0] ? " selected": "" %>><%= type[1] %></option>
							<% } %>
						</select>
					</div>
				</div>
				<div class="fields">
					<div class="eight wide field">
						<label>Pronunciation</label>
						<table id="pronunciation-field" class="ui compact table">
							<tbody>
								<tr>
									<td>
										<input class="syllables-cell" type="text" placeholder="ta-ron" value="<%= word['pronunciation'] ? word['pronunciation'][0] : '' %>">
									</td>
									<td class="five wide">
										<input class="stress-cell" type="number" placeholder="1" value="<%= word['pronunciation'] ? word['pronunciation'][1] : '' %>">
									</td>
									<td class="one wide">
										<div class="ui disabled floated small icon button">
											<i class="delete icon"></i>
										</div>
									</td>
									<td class="one wide">
										<div class="ui disabled floated small icon button">
											<i class="add icon"></i>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="eight wide field">
						<div id="v-option" style="display: none;">
							<label>Infix positions</label>
							<input id="infixes-field" type="text" placeholder="t.ar.on" value="<%= word['infixes'] %>">
							<span class="muted">Mark the infix positions with two dots.</span>
						</div>
						<% if (word['conjugation']) { %>
						<p class="warning">This word has a custom conjugation associated with it, which currently cannot be edited in the online editor.</p>
						<% } %>
						<% if (word['short_translation']) { %>
						<p class="warning">This word has a short translation associated with it, which currently cannot be edited in the online editor.</p>
						<% } %>
						<% if (word['seeAlso']) { %>
						<p class="warning">This word has a <i>See also</i> section, which currently cannot be edited in the online editor.</p>
						<% } %>
						<% if (word['image']) { %>
						<p class="warning">This word has an image associated with it, which currently cannot be edited in the online editor.</p>
						<% } %>
					</div>
					<textarea style="display: none;" id="conjugation-field"><%= JSON.stringify(word['conjugation']) %></textarea>
					<textarea style="display: none;" id="short-translation-field"><%= word['short_translation'] %></textarea>
					<textarea style="display: none;" id="see-also-field"><%= JSON.stringify(word['seeAlso']) %></textarea>
					<textarea style="display: none;" id="image-field"><%= word['image'] %></textarea>
				</div>

				<div class="ui section divider"></div>

				<h2>Definition</h2>
				<div class="field">
					<table id="definition-field" class="ui compact definition table">
						<tbody>
							<% for (let i = 0; i < word['translations'].length; i++) {
								const translation = word['translations'][i]; %>
							<tr>
								<td class="one wide">1.</td>
								<td>
									<input type="text" placeholder="to hunt" value="<%= translation['en'] %>"<% for (let lang of Object.keys(translation)) { if (lang !== 'en') { %> data-<%= lang %>="<%= translation[lang] %>"<% } } %>>
								</td>
								<td class="one wide">
									<div class="translation-button ui floated small icon button" data-tooltip="Edit translations">
										<i class="globe icon"></i>
									</div>
								</td>
								<td class="one wide">
									<div class="ui disabled floated small icon button" data-tooltip="Delete this meaning">
										<i class="delete icon"></i>
									</div>
								</td>
								<td class="one wide">
									<div class="ui disabled floated small icon button" data-tooltip="Add another meaning">
										<i class="add icon"></i>
									</div>
								</td>
							</tr>
							<% } %>
						</tbody>
					</table>
				</div>
				<div class="fields">
					<div class="eight wide field">
						<label>Meaning note</label>
						<textarea id="meaning-note-field" rows="2"><%= word['meaning_note'] %></textarea>
						<span class="muted">Free-form additional information on the meaning of the word, such as a clarification on the scope of the word.</span>
					</div>
					<div class="eight wide field">
						<label>Conjugation note</label>
						<textarea id="conjugation-note-field" rows="2"><%= word['conjugation_note'] %></textarea>
						<span class="muted">In case this word has conjugation exceptions (e.g., missing or alternate forms), they can be noted here.</span>
					</div>
				</div>

				<div class="ui section divider"></div>

				<h2>Status, etymology, and source</h2>
				<div class="fields">
					<div class="four wide field">
						<label>Status</label>
						<select id="status-field" class="ui selection dropdown">
							<option value="none">&ndash;</option>
							<option value="loan"<%= word['status'] === 'loan' ? ' selected' : '' %>>loan</option>
							<option value="unconfirmed"<%= word['status'] === 'unconfirmed' ? ' selected' : '' %>>unconfirmed</option>
						</select>
					</div>
					<div class="twelve wide field">
						<label>Status note <i>(optional)</i></label>
						<input id="status-note-field" type="text" value="<%= word['status_note'] %>">
					</div>
				</div>
				<div class="field">
					<label>Etymology</label>
					<textarea id="etymology-field" rows="2"><%= word['etymology'] %></textarea>
				</div>
				<% if (!word.hasOwnProperty('source')) {
					word['source'] = '';
				}
				if (typeof word['source'] === 'string') {
					word['source'] = [word['source']];
				} %>
				<div class="fields">
					<div class="six wide field">
						<label>Source name</label>
						<input id="source-name-field" type="text" value="<%= word['source'][0] %>">
					</div>
					<div class="six wide field">
						<label>Source URL</label>
						<input id="source-url-field" type="url" value="<%= word['source'][1] %>">
					</div>
					<div class="four wide field">
						<label>Source date</label>
						<input id="source-date-field" type="date" value="<%= word['source'][2] %>">
					</div>
				</div>

				<div class="ui section divider"></div>

				<!--<h2>Image and audio</h2>
				<p class="muted">These are not currently editable in this editor.</p>

				<div class="fields">
					<div class="eight wide field">
						<label>Image</label>
						<% if (word['image']) { %>
						<img src="/ayrel/<%- word['image'] %>" style="width: 100%;">
						<% } else { %>
						<i>(no image)</i>
						<% } %>
					</div>
					<div class="eight wide field">
						<label>Audio</label>
						<i>(no audio)</i>
					</div>
				</div>

				<div class="ui section divider"></div>-->

				<a href="/" class="ui floated right submit button">
					Cancel
				</a>
				<div id="save-button" class="ui floated right primary submit icon labeled button">
					<i class="check icon"></i>
					Save
				</div>
			</div>
		</div>

		<div id="translations-modal" class="ui modal">
			<div class="header">Edit translations</div>
			<div class="scrolling content">
				<div class="ui form">
					<table class="ui compact celled definition table">
						<tbody>
							<tr>
								<td class="three wide">English</td>
								<td id="translation-en-field" class="eleven wide">to hunt</td>
							</tr>
							<% for (let lang of languages) { %>
							<tr>
								<td><%= lang[0] %></td>
								<td>
									<div class="field">
										<input id="translation-<%= lang[1] %>-field" type="text"></input>
									</div>
								</td>
							</tr>
							<% } %>
						</tbody>
					</table>
				</div>
			</div>
			<div class="actions">
				<div id="translations-modal-cancel-button" class="ui basic button">
					<i class="close icon"></i> Cancel
				</div>
				<div id="translations-modal-ok-button" class="ui primary approve button">
					<i class="checkmark icon"></i> OK
				</div>
			</div>
		</div>

		<script src="aysrungsiyu/jquery/jquery-3.3.1.js"></script>
		<script src="aysrungsiyu/semantic/dist/semantic.js"></script>
		<script src="ayvefya/edit.js"></script>
	</body>
</html>

